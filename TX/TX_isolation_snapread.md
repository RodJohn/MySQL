
# 快照读

    对于普通select语句
    innodb采用快照读的方式
    (快照读原名一致性非锁定读 consistent nonlocking read)

# 原理
    
    innodb
    使用undo日志之间的版本链来保存记录的历史值
    使用ReadView来设定快照的节点
    获取记录后
    比较视图的trxId和记录版本上的trxId
    判断版本链中的哪个版本是当前事务可见的

# 优点
    
    读不加锁，读写不冲突。
    在读多写少的OLTP应用中，读写不冲突是非常重要的，极大的增加了系统的并发性能

    实现了完全的隔离级别



# 长事务

    长事务意味着系统里面会存在很老的事务视图。
    由于这些事务随时可能访问数据库里面的任何数据，
    所以这个事务提交之前，数据库里面它可能用到的回滚记录都必须保留，这就会导致大量占用存储空间

    可重复读级别只在第一次快照读的时候生成一个视图
    直到事务提交视图才会被废弃，会导致需要保存更久的undo日志
    提交读级别在每次快照读时都生成一个视图
    能够让undo日志更快的被清理
